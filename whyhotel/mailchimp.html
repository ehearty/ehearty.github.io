<HTML>

<HEAD>
</HEAD>
<BODY>
<p style="position:absolute; top:20%;width:100%;text-align:center">
CLICK <span style="color:red;cursor: pointer;" onclick="openMailChimp()">HERE</span>
TO OPEN MAILCHIMP. 
<br/>PLEASE CLOSE THE WINDOW WHEN YOU ARE FINISHED.
</p>
<script>
'use strict';


var childWin = null;

window.addEventListener("visibilitychange", async event => {
  event.preventDefault();
  console.log("visibilityChange");
  await childWin.close();
  childWin = null;
  return false;
}, false);

window.addEventListener("freeze", async event => {
  event.preventDefault();
  console.log("freeze");
  childWin = null;
  await childWin.close();
  return false;
}, false);

window.addEventListener("beforeunload", async event => {
  event.preventDefault();
  console.log("beforeunload");
  childWin = null;
  await childWin.close();
  return false;
}, false);

window.addEventListener("pagehide", async event => {
  event.preventDefault();
  console.log("INSIDE PAGE HIDE");
  childWin = null;
  await childWin.close();
  return false;
}, false);


function openMailChimp(){
let w = window.innerWidth;
let h = window.innerHeight;
let sx = window.screenX + 250;
let sy = window.screenY;
let oh = window.outerHeight;
let vv = window.visualViewport;

let params = `scrollbars=no,resizable=no,status=no,location=no,toolbar=no,titlebar=no,menubar=no,
width=${vv.width},height=${vv.height - 50},left=${sx},top=${sy + (oh - h)}`;

if (!childWin){
	childWin = open('https://us2.admin.mailchimp.com/audience', 'mailchimp', params);
};
};


setTimeout(function(){openMailChimp();},500);
</script>
</BODY>
</HTML>
